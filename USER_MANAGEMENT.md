# 用户管理说明文档

## 概述

医学图像标注系统采用配置文件方式管理用户，无需通过前端界面进行用户注册和管理。所有用户信息都在后端配置文件中维护，确保系统安全性和用户管理的集中化。

## 用户配置文件

**文件路径：** `backend/app/user_config.py`

### 配置结构

```python
SYSTEM_USERS = [
    {
        "username": "用户名",
        "password": "密码", 
        "role": "角色",
        "description": "用户描述"
    }
]
```

### 角色类型

- **admin（管理员）**：拥有所有权限，可以管理数据集、用户，查看所有统计
- **doctor（医生）**：专业标注人员，标注结果作为专家标注
- **student（学生）**：学习标注人员，标注结果作为学生标注

### 角色映射

- admin → expert_id: 0（真实标签）
- doctor → expert_id: 1（专家标注）  
- student → expert_id: 2（学生标注）

## 用户管理操作

### 1. 添加新用户

在 `SYSTEM_USERS` 列表中添加新的用户字典：

```python
{
    "username": "newuser",
    "password": "secure_password", 
    "role": "doctor",
    "description": "新加入的医生用户"
}
```

### 2. 删除用户

从 `SYSTEM_USERS` 列表中删除对应的用户条目。

### 3. 修改用户信息

直接修改对应用户的字段：

```python
# 修改密码
"password": "new_password"

# 修改角色
"role": "admin"

# 修改描述
"description": "更新后的用户描述"
```

### 4. 重置密码

找到对应用户，修改其 `password` 字段。

## 安全建议

1. **强密码策略**：建议使用包含大小写字母、数字和特殊字符的强密码
2. **定期更换密码**：建议定期更换用户密码
3. **权限最小化**：仅给用户必要的角色权限
4. **备份配置**：修改前备份用户配置文件

## 操作流程

1. 停止后端服务
2. 修改 `backend/app/user_config.py` 文件
3. 保存文件
4. 重启后端服务
5. 通过管理员界面验证修改是否生效

## 注意事项

- 修改后必须重启后端服务才能生效
- username 必须保持唯一性
- role 必须是 admin、doctor、student 之一
- 建议保留至少一个 admin 用户
- 用户数据修改会影响所有相关的标注统计

## 管理员界面

系统管理员可以通过前端的"数据集管理" → "用户管理"查看：

- 当前系统用户列表
- 用户角色和描述
- 用户管理操作指导
- 配置文件路径和修改说明

## 故障排除

### 问题：修改用户配置后无法登录

**解决方案：**
1. 检查配置文件语法是否正确
2. 确认用户名拼写是否正确
3. 验证密码是否正确设置
4. 重启后端服务

### 问题：用户角色权限不正确

**解决方案：**
1. 检查用户的 role 字段是否为有效值
2. 确认 ROLE_TO_EXPERT_ID 映射是否正确
3. 重启后端服务使配置生效

### 问题：无法访问管理功能

**解决方案：**
1. 确认用户角色为 admin
2. 检查前端权限判断逻辑
3. 验证后端API权限控制